# Inventory System

页面贡献者：[Max1122Chen](https://github.com/Max1122Chen)

更新时间：2025.10.25

## 简介

- 类型：个人撰写文章
- 作者：[Max1122Chen](https://github.com/Max1122Chen)
- 前置科技：C++面向对象程序设计
- 级别：入门级
- 难度：⭐ 
- 面向对象：游戏开发工程师，设计师



## 正文

在现代电子游戏中，让玩家能够在游玩过程中获得一些“物品“，是非常常见的一种游戏玩法。例如可以获得武器、防具、消耗品、素材、可放置物品等等，甚至游戏中的货币也可以纳入这一范畴（取决于具体的游戏如何对待它）。因此为游戏中的”物品“和”物品栏“设计一个灵活、高度可扩展、易于管理的游戏系统是很有必要的，在下文我们能够进一步说明这种必要性。

!!! note
    需要澄清的是，本文所讨论的“游戏物品并非一切出现在游戏中的具有实体的事物，本文所指的”游戏物品“可以和”物品栏“”背包“”储存箱“等容器概念形成上下文一起理解，本文所想讨论的”游戏物品“是那些被认为常常可以被存放于”物品栏“这种容器中的事物。



### 游戏物品

”游戏物品“蕴含了几个功能：

1. 构建游戏的”游戏性“

   武器、防具、饰品、消耗品等物品与游戏的战斗系统有关，它们服务于战斗玩法的构建；素材可能与游戏的数值养成系统、制造合成系统等有关；可放置物品可能和游戏的建造创造玩法有关……

   总之，游戏物品往往对其他游戏性系统的构建起到不可或缺的支撑作用。

2. 服务于游戏的故事叙述

   有时候，游戏物品还会承担叙事的工具，它对叙事的贡献既可能是显性的也可能是隐性的。显性体现在物品的文本性描述。隐性体现在物品本身的属性，例如外形、功能、社会历史意义；以及物品出现的时间与空间。

   举一个例子来说，《黑暗之魂》系列格外热衷于把叙事的任务交给游戏中的物品，且既重视物品文本描述的显性叙事，也考究物品出现的时间空间，构建出了富有特色的碎片性叙事。

   
   
3. 为玩家提供“收获感”和奖励

   一般来说，极少情况下获得一件物品对于玩家来说是一件坏事。只有设计者故意将物品设计成一种诅咒性的不祥之物，才容易引发玩家的厌弃。

   通常玩家获得一件物品，都能够欣然接受它，而如果它能够对玩家的进一步游玩有较大的帮助的话，玩家便会更加高兴。

   除此之外，物品也常常作为游戏进程中通用的奖励手段，来给予玩家持续的正反馈。



游戏物品在现代电子游戏中有如此重要的作用，值得我们仔细思考如何构建一个灵活、健全、可扩展的“游戏物品系统”。



#### 游戏物品是什么？

“物品”不就是“物品”吗？

先来举几个例子，来帮助我们分析：

在《Minecraft》中， 我们每时每刻都在和其中的游戏物品交互：玩家在游戏世界中见到的大部分的东西都是游戏物品，因为世界上几乎每一个方块都可以被玩家采集并放进玩家的背包中。

《Minecraft》中的游戏物品主要展现出了这些属性与行为：

- 玩家能够采集世界中的方块，它们可能会以游戏物品的形式掉落
- 玩家能够以方块形式采集到的物品，还能够再放回到世界中。
- 玩家能够通过各种制造台把一些游戏物品或“合成”，或“转变”成别的游戏物品。
- 玩家可以手持武器作战、身穿装备防御、使用消耗品获得增减益。

我们不难发现，我们提取出来的游戏物品的属性与行为之间反映出课显著的”特性“，例如不是所有物品都能作为武器，不是所有物品都能够作为方块放回世界中。

这说明了这些属性并非游戏物品的”共性“，而是某个特定种类的游戏物品所具有的“共性”，也能够看出“游戏物品”是一个抽象的高层概念。



#### 游戏物品定义

要定义”游戏物品“，关键在于抽象”游戏物品“所应该具有的属性和行为。那么，首先，让我们先来探索共性，有哪些属性和行为是所有游戏物品所**共有的**？

**必要属性：**

1. 物品ID——游戏物品的唯一标识符，比“名字”更容易进行比较
2. 物品名字——一般来说游戏中的物品都需要
3. 物品类型——是武器？是消耗品？……
4. 物品描述——可以没有这条属性，取决于游戏的需要
5. 物品实体——可能包含以下事项
   1. 物品的“图标”——游戏物品的一个指代
   2. 物品的模型——游戏物品在游戏世界中的视觉表现

**次要属性（取决于游戏需要）：**

1. 物品等级
2. 物品合成配方
3. ……



我们可以发现，我们现在把游戏物品描述称为了一种**“概念”**，而并非一种“实体”。某种角度上来说，对于游戏世界中的物品，是先有设计师设计物品的”意识“，才有游戏内实现的物品的”物质“。

我们暂时没有关心单独的一个游戏物品，并没有关心一个游戏物品在世界中的空间位置、数量等等属性。这是因为游戏物品的实体，都是游戏物品的概念的一个实例。游戏物品的“名字””描述“等属性是该种游戏物品所共有的，而空间位置、数量等是某个游戏物品实例所独有的。

而一种“概念”，并不需要实现”被获取“这种行为，在后面我们能够看出来。

因此，我们可以将游戏物品分成”定义“（也就是”概念“的部分）和“实例”的部分，从上述的分析中，你应该能够看出它们并非类和对象的关系，而是两个类，物品实例类（ItemInstance）的一个对象引用了物品定义类（ItemDefinition）的一个对象。

现在我们终于可以用代码来简单描述一下”游戏物品定义“了：

```c++
class ItemDefinition
{
 private:
    unsigned int itemID;
    string itemName;
    ItemType itemType; //枚举或其他类似于枚举的类
    string itemDescription;
    Image* itemIcon;
    Model* itemModel; //物品的模型不仅仅是一个网格，可能还包含了材质等等
    
 public:
	//...some behaviours
    
}
```

那么武器、防具、消耗品等等细分的物品，它们同样先具有ID，名字等游戏物品共有的属性，自然可以采用继承的方式来扩展物品定义，实现WeaponItemDefinition, ArmorItemDefinition, ConsumableItemDefinition等子类，增加其特有的属性和行为。

```c++
// For example
class WeaponItemDefinition : public ItemDefinition
{
 private:
    //Possible Properties
 	float damage;
    DamageType damageType;
    //...
    
 public:
    //Possible Behaviors
    void equipped(); //be equipped by somebody
    //...
}

class ArmorItemDefinition : public ItemDefinition
{
     private:
    //Possible Properties
 	float defense;
    DefenseType defenseType;
    //...
    
 public:
    //Possible Behaviors
    void equipped(); //be equipped by somebody
    //...
}

class ConsumableItemDefinition : public ItemDefinition
{
     private:
    //Possible Properties
 	GameplayEffect effect;
    //...
    
 public:
    //Possible Behaviors
    void consumed(); //be consumed by somebody
    //...
}
//...
```

实际上，武器，防具等具有更多复杂行为的物品的Definition往往不会如此简单，甚至有必要把它们单独建立一个与ItemDefinition独立的EquippementDefinition。对于玩家而言，他们只需要关心Equipment的属性、效果即可。但对于开发者来说，武器装备怎样穿戴在角色身上、穿戴在角色的什么位置上、播放什么攻击动画等等这些信息也是需要在EquipmentDefinition中体现的。举一反三，其他具有更特殊的行为的游戏物品也可能需要单独定义Definition，但是我们都可以遵循用Definition描述物品，用Instance实例化物品的逻辑。

#### 游戏物品实例